<!DOCTYPE html>
<html>
<head>
  <title>Hostel Admin Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {margin:0;font-family:Arial;background:#f1f5f9}
    .login-box, .dashboard {max-width:400px;margin:80px auto;padding:20px;background:white;border-radius:10px;box-shadow:0 0 10px gray}
    input {width:95%;padding:8px;margin:8px 0}
    button {padding:8px 15px;background:#1e3a8a;color:white;border:none;cursor:pointer;border-radius:5px}
    .hidden {display:none}
    .student {background:#e0f2fe;padding:8px;margin:8px 0;border-radius:6px}
  </style>
</head>

<body>

<div id="loginPage" class="login-box">
  <h2>Admin Login</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<div id="dashboardPage" class="dashboard hidden">
  <h2>üè® Hostel Admin Panel</h2>
  <button onclick="logout()">Logout</button>

  <h3>Total Students: <span id="count">0</span></h3>

  <input type="text" id="name" placeholder="Student Name">
  <input type="text" id="father" placeholder="Father Name">
  <input type="date" id="dob">
  <input type="text" id="state" placeholder="State">
  <input type="text" id="tribe" placeholder="Tribe">
  <input type="text" id="class" placeholder="Class">

  <button onclick="addStudent()">Add Student</button>

  <div id="studentList"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_BUCKET",
  messagingSenderId: "YOUR_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = function() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  signInWithEmailAndPassword(auth, email, password)
  .then(() => {
    document.getElementById("loginPage").classList.add("hidden");
    document.getElementById("dashboardPage").classList.remove("hidden");
    loadStudents();
  })
  .catch(() => alert("Login Failed"));
}

window.logout = function() {
  signOut(auth).then(() => {
    document.getElementById("dashboardPage").classList.add("hidden");
    document.getElementById("loginPage").classList.remove("hidden");
  });
}

window.addStudent = async function() {
  const student = {
    name: name.value,
    father: father.value,
    dob: dob.value,
    state: state.value,
    tribe: tribe.value,
    class: class.value
  };

  await addDoc(collection(db, "students"), student);
  alert("Student Added");
  loadStudents();
}

async function loadStudents() {
  const snapshot = await getDocs(collection(db, "students"));
  studentList.innerHTML = "";
  count.innerText = snapshot.size;

  snapshot.forEach(docSnap => {
    const s = docSnap.data();
    studentList.innerHTML += `
      <div class="student">
        <b>${s.name}</b> - ${s.class}
        <button onclick="deleteStudent('${docSnap.id}')">Delete</button>
      </div>
    `;
  });
}

window.deleteStudent = async function(id) {
  await deleteDoc(doc(db, "students", id));
  loadStudents();
}
</script>

</body>
</html>
